{% extends 'layout.html' %}
{% block content %}
    <div class="container col-xl-10 col-xxl-8 px-4">
        <div class="row align-items-center g-lg-5 py-5">
          <div class="col-lg-5 text-center text-lg-start">
            <h1 class="display-4 fw-bold lh-1 text-body-emphasis mb-3">Contacto</h1>
          </div>
          <div class="col-md-10 mx-auto col-lg-7">
            <form id="contact-form" class="p-4 p-md-5" method="post">
              {% csrf_token %}
              <div class="form-floating mb-3">
                <input type="text" class="form-control" id="floatingName" name="name">
                <label for="floatingName">Nombre</label>
              </div>
              <div class="form-floating mb-3">
                <input type="text" class="form-control" id="floatingLastName" name="last_name">
                <label for="floatingLastName">Apellido</label>
              </div>
              <div class="form-floating mb-3">
                <input type="email" class="form-control" id="floatingInput" name="email">
                <label for="floatingInput">Email</label>
              </div>
              <div class="form-floating mb-3">
                <textarea class="form-control" id="exampleFormControlTextarea1" rows="4" name="text"></textarea>
                <label for="exampleFormControlTextarea1">Texto</label>
              </div>

              <button class="w-100 btn btn-lg btn-primary" type="submit">Enviar</button>
            </form>
          </div>
        </div>
    </div>

    <div class="toast align-items-center text-white bg-success border-0" role="alert" aria-live="assertive" aria-atomic="true" style="position: absolute; top: 1rem; right: 1rem; display: none;" id="success-toast">
      <div class="d-flex">
          <div class="toast-body">
              Mensaje enviado exitosamente.
          </div>
          <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
      </div>
    </div>

    <script>
      $(document).ready(function () {
        $("#contact-form").submit(function (e) {
          e.preventDefault();
          var formData = $(this).serialize();
    
          $.ajax({
            type: "POST",
            url: "{% url 'contacto' %}",
            data: formData,
            success: function (response) {
              $("#contact-form")[0].reset();
              var toast = $("#success-toast");
              toast.find(".toast-body").text(response.message);
              toast.show();
              setTimeout(function () {
                toast.hide();
              }, 10000); // Hide the toast after 10 seconds
    
              $("#contact-form")[0].reset(); // Limpiar el formulario
            },
            error: function (error) {
              console.error(error);
            }
          });
        });
      });
    </script>
    
{% endblock %}
